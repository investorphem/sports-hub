<!DOCTYPE html>
<html lang="en">
<head><script type="module">
  import { sdk } from "https://esm.sh/@farcaster/miniapp-sdk";

  window.addEventListener("DOMContentLoaded", async () => {
    // Your app initialization (fetch API, render UI, etc.)
    
    // When everything is loaded, tell Farcaster:
    await sdk.actions.ready();
  });
</script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sports Hub</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f7f7f7; }
    h1 { color: #2c3e50; }
    select, input, button { margin: 5px; padding: 8px; }
    .match { background: white; padding: 10px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <h1>âš½ Sports Hub</h1>

  <label for="competition">Competition:</label>
  <select id="competition">
    <option value="2021">Premier League</option>
    <option value="2016">Championship</option>
  </select>

  <label for="dateFrom">From:</label>
  <input type="date" id="dateFrom" />

  <label for="dateTo">To:</label>
  <input type="date" id="dateTo" />

  <button onclick="loadMatches()">Get Matches</button>

  <div id="matches"></div>

  <script>
    async function loadMatches() {
      const competitionId = document.getElementById("competition").value;
      const dateFrom = document.getElementById("dateFrom").value;
      const dateTo = document.getElementById("dateTo").value;

      let url = `/api/football?competitionId=${competitionId}`;
      if (dateFrom) url += `&dateFrom=${dateFrom}`;
      if (dateTo) url += `&dateTo=${dateTo}`;

      document.getElementById("matches").innerHTML = "Loading...";

      const res = await fetch(url);
      const data = await res.json();

      const container = document.getElementById("matches");
      container.innerHTML = "";

      if (data.matches.length === 0) {
        container.innerHTML = "<p>No matches found for this range.</p>";
        return;
      }

      data.matches.forEach(m => {
        const div = document.createElement("div");
        div.className = "match";
        div.innerHTML = `
          <strong>${m.competition.name}</strong><br>
          ${m.homeTeam.name} vs ${m.awayTeam.name}<br>
          Date: ${new Date(m.utcDate).toLocaleString()}<br>
          Status: ${m.status}
        `;
        container.appendChild(div);
      });
    }
  </script>
</body>
</html>
